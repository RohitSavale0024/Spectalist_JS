<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Spectalist</title>
  <link rel="stylesheet" href="https://pro.fontawesome.com/releases/v5.10.0/css/all.css" />
  <link rel="stylesheet" type="text/css" href="style1.css">
</head>

<body>

  <section id="header">
    <a href="home.html"><img src="image/logo.png" class="logo" alt="" width="180" height="50"></a>
    <div>
      <ul id="navbar">
        <li id="signin"><a href="signin.html">Sign In</a></li>
        <li id="signup"><a href="signup.html">Sign Up</a></li>
        <li><a href="cart.html"><i class="fa fa-shopping-cart"></i></a></li>
      </ul>
    </div>
  </section>

  <h2>Sunglasses</h2>
  <section class="features">
    <br>
    <!-- 1 -->
    <div class="feature-item">
      <div class="feature-item-product">
        <img src="image/gog1.png" alt="Image" class="image-zoom">
      </div>
      <h3>Tortoise Full Rim Wayfarer</h3>
      <p>&#8377;1299</p>

      <a class="btn add-to-cart">Add to cart</a>

    </div>
    <div class="feature-item">
      <div class="feature-item-product">
        <img src="image/gog2.png" alt="Image" class="image-zoom">
      </div>
      <h3>Blue Full Rim Wayfarer</h3>
      <p>&#8377;1599</p>

      <a class="btn add-to-cart">Add to cart</a>

    </div>
    <div class="feature-item">
      <div class="feature-item-product">
        <img src="image/gog3.png" alt="Image" class="image-zoom">
      </div>
      <h3>Silver Full Rim Round</h3>
      <p>&#8377;1599</p>

      <a class="btn add-to-cart">Add to cart</a>

    </div>


    <br>
    <!-- 2 -->

    <div class="feature-item">
      <div class="feature-item-product">
        <img src="image/gog4.png" alt="Image" class="image-zoom">
      </div>
      <h3>Black Full Rim Aviator</h3>
      <p>&#8377;1299</p>
      <a class="btn add-to-cart">Add to cart</a>
    </div>
    <div class="feature-item">
      <div class="feature-item-product">
        <img src="image/gog5.png" alt="Image" class="image-zoom">
      </div>
      <h3>Golden Full Rim Rectangle</h3>
      <p>&#8377;1599</p>

      <a class="btn add-to-cart">Add to cart</a>

    </div>
    <div class="feature-item">
      <div class="feature-item-product">
        <img src="image/gog6.png" alt="Image" class="image-zoom">
      </div>
      <h3>Gold Full Rim Aviator</h3>
      <p>&#8377;1599</p>

      <a class="btn add-to-cart">Add to cart</a>

    </div>

    <br>

    <!-- 3 -->
    <div class="feature-item">
      <div class="feature-item-product">
        <img src="image/gog7.png" alt="Image" class="image-zoom">
      </div>
      <h3>Gold Full Rim Geometric</h3>
      <p>&#8377;1599</p>
      <div class="feature-item-product2">
        <a class="btn add-to-cart">Add to cart</a>
      </div>
    </div>
    <div class="feature-item">
      <div class="feature-item-product">
        <img src="image/gog8.png" alt="Image" class="image-zoom">
      </div>
      <h3>Gold Blue Full Rim Pilot</h3>
      <p>&#8377;1299</p>
      <div class="feature-item-product2">
        <a class="btn add-to-cart">Add to cart</a>
      </div>
    </div>
    <div class="feature-item">
      <div class="feature-item-product">
        <img src="image/gog9.png" alt="Image" class="image-zoom">
      </div>
      <h3>Red Black Full Rim Wayfarer</h3>
      <p>&#8377;3200</p>
      <div class="feature-item-product2">
        <a class="btn add-to-cart">Add to cart</a>
      </div>
    </div>

    <br>

    <!-- 4-->
    <div class="feature-item">
      <div class="feature-item-product">
        <img src="image/gog10.png" alt="Image" class="image-zoom">
      </div>
      <h3>Gold Full Rim Round</h3>
      <p>&#8377;1599</p>
      <div class="feature-item-product2">
        <a class="btn add-to-cart">Add to cart</a>
      </div>
    </div>
    <div class="feature-item">
      <div class="feature-item-product">
        <img src="image/gog11.png" alt="Image" class="image-zoom">
      </div>
      <h3>Gunmetal Orange Full Rim Rectangle</h3>
      <p>&#8377;2700</p>
      <div class="feature-item-product2">
        <a class="btn add-to-cart">Add to cart</a>
      </div>
    </div>
    <div class="feature-item">
      <div class="feature-item-product">
        <img src="image/gog12.png" alt="Image" class="image-zoom">
      </div>
      <h3>Grey Full Rim Round</h3>
      <p>&#8377;1599</p>
      <div class="feature-item-product2">
        <a class="btn add-to-cart">Add to cart</a>
      </div>
    </div>

    <br>

    <!--5-->
    <div class="feature-item">
      <div class="feature-item-product">
        <img src="image/gog13.png" alt="Image" class="image-zoom">
      </div>
      <h3>Gold Full Rim Round</h3>
      <p>&#8377;1599</p>
      <div class="feature-item-product2">
        <a class="btn add-to-cart">Add to cart</a>
      </div>
    </div>
    <div class="feature-item">
      <div class="feature-item-product">
        <img src="image/gog14.png" alt="Image" class="image-zoom">
      </div>
      <h3>Gold Full Rim Round</h3>
      <p>&#8377;1599</p>
      <div class="feature-item-product2">
        <a class="btn add-to-cart">Add to cart</a>
      </div>
    </div>
    <div class="feature-item">
      <div class="feature-item-product">
        <img src="image/gog15.png" alt="Image" class="image-zoom">
      </div>
      <h3>Gunmetal Full Rim Round</h3>
      <p>&#8377;1599</p>
      <div class="feature-item-product2">
        <a class="btn add-to-cart">Add to cart</a>
      </div>
    </div>

    <br>

    <!--6-->
    <div class="feature-item">
      <div class="feature-item-product">
        <img src="image/gog16.png" alt="Image" class="image-zoom">
      </div>
      <h3>Blue Full Rim Wayfarer</h3>
      <p>&#8377;1599</p>
      <div class="feature-item-product2">
        <a class="btn add-to-cart">Add to cart</a>
      </div>
    </div>
    <div class="feature-item">
      <div class="feature-item-product">
        <img src="image/gog17.png" alt="Image" class="image-zoom">
      </div>
      <h3>Silver Full Rim Aviator</h3>
      <p>&#8377;1599</p>
      <div class="feature-item-product2">
        <a class="btn add-to-cart">Add to cart</a>
      </div>
    </div>
    <div class="feature-item">
      <div class="feature-item-product">
        <img src="image/gog18.png" alt="Image" class="image-zoom">
      </div>
      <h3>Matte Black Full Rim Wayfarer</h3>
      <p>&#8377;1599</p>
      <div class="feature-item-product2">
        <a class="btn add-to-cart">Add to cart</a>
      </div>
    </div>

    <br>

    <!--7-->
    <div class="feature-item">
      <div class="feature-item-product">
        <img src="image/gog19.png" alt="Image" class="image-zoom">
      </div>
      <h3>Black Full Rim Wayfarer</h3>
      <p>&#8377;1599</p>
      <div class="feature-item-product2">
        <a class="btn add-to-cart">Add to cart</a>
      </div>
    </div>
    <div class="feature-item">
      <div class="feature-item-product">
        <img src="image/gog20.png" alt="Image" class="image-zoom">
      </div>
      <h3>Cat eyed Frame</h3>
      <p>&#8377;1499</p>
      <div class="feature-item-product2">
        <a class="btn add-to-cart">Add to cart</a>
      </div>
    </div>
    <div class="feature-item">
      <div class="feature-item-product">
        <img src="image/gog21.png" alt="Image" class="image-zoom">
      </div>
      <h3>Ralph Lauren Prep 70 075</h3>
      <p>&#8377;1699</p>
      <div class="feature-item-product2">
        <a class="btn add-to-cart">Add to cart</a>
      </div>
    </div>
    <br>

    <!--8-->
    <div class="feature-item">
      <div class="feature-item-product">
        <img src="image/gog22.png" alt="Image" class="image-zoom">
      </div>
      <h3>Pink Full Rim Cat Eye</h3>
      <p>&#8377;1699</p>
      <div class="feature-item-product2">
        <a class="btn add-to-cart">Add to cart</a>
      </div>
    </div>
    <div class="feature-item">
      <div class="feature-item-product">
        <img src="image/gog23.png" alt="Image" class="image-zoom">
      </div>
      <h3>Matte Black Grey Wooden Full Rim Cat Eye</h3>
      <p>&#8377;999</p>
      <div class="feature-item-product2">
        <a class="btn add-to-cart">Add to cart</a>
      </div>
    </div>
    <div class="feature-item">
      <div class="feature-item-product">
        <img src="image/gog24.png" alt="Image" class="image-zoom">
      </div>
      <h3>Silver Half Rim Cat Eye</h3>
      <p>&#8377;1599</p>
      <div class="feature-item-product2">
        <a class="btn add-to-cart">Add to cart</a>
      </div>
    </div>

  </section>


  <br>
  <br>


  <footer class="h-footer">
    <p>&copy; 2023 Spectacles and Goggles Store. All rights reserved.</p>
  </footer>

  <script src="script.js"></script>

  <script>
    document.addEventListener('DOMContentLoaded', async () => {
      const loginData = sessionStorage.getItem("login-data");
      const loginDataObj = JSON.parse(loginData);
      const navbar = document.getElementById("navbar");
      const signin = document.getElementById("signin");
      const signup = document.getElementById("signup");

      if (loginDataObj) {
        const userName = loginDataObj.username;
        const userNameElement = document.createElement("span");
        userNameElement.classList += "user";
        userNameElement.textContent = `${userName}  `;
        signin.classList.add("hide");
        signup.classList.add("hide");
        navbar.appendChild(userNameElement);
        const logout = document.createElement("button");
        logout.innerText = "logout";
        logout.setAttribute("id", "logout");
        logout.addEventListener("click", function () {
          sessionStorage.setItem("login-data", {});
          signin.classList.remove("hide");
          signup.classList.remove("hide");
          navbar.removeChild(userNameElement);
          navbar.removeChild(logout);
        })
        navbar.appendChild(logout);
      } else {
        signin.classList.remove("hide");
        signup.classList.remove("hide");
      }
    });
    const addToCart = async (e) => {
      const cartBtn = e.target;
      const imageCard = cartBtn.closest(".feature-item");
      const itemName = imageCard.querySelector("h3").textContent;
      let price = imageCard.querySelector("p").textContent;
      price = price.slice(1); // Remove the first character (currency symbol)
      let img = imageCard.querySelector(".image-zoom").src;
      img = img.slice(22, -1); // Extract the image URL portion

      console.log(itemName, price, img);

      try {
        const loginData = JSON.parse(sessionStorage.getItem("login-data"));
        const headers = new Headers();
        headers.append('Content-Type', 'application/json');

        const response = await fetch('http://localhost:5000/api/addtocart', {
          method: 'POST',
          headers: headers,
          body: JSON.stringify({
            itemName,
            price,
            img,
            userId: loginData["_id"]
          })
        });

        const data = await response.json();

        if (data.status === "ok") {
          console.log(data.data);
          showSnackbar("Product added to cart");
                } else {
                    console.log("Failed to add item to cart.");
                    showSnackbar("Failed to add item to cart");
                }
            } catch (error) {
                console.error(error);
                alert("An error occurred while adding the item to the cart.");
                showSnackbar("An error occurred while adding the item to the cart");
            }
        };


        const showSnackbar = (message) => {
    const snackbar = document.getElementById("snackbar");
    snackbar.textContent = message;
    snackbar.classList.add("show");
    setTimeout(() => {
        snackbar.classList.remove("show");
    }, 3000);
};

    document.addEventListener("DOMContentLoaded", function () {
      const itemDivs = document.querySelectorAll(".feature-item");
      itemDivs.forEach((item) => {
        const actionButton = item.querySelector(".add-to-cart");
        actionButton.addEventListener("click", addToCart);
      });
    });

  </script>
</body>

</html>